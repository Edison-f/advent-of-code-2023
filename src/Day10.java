import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.Scanner;
import java.util.Stack;

public class Day10 {

    // Up Down Left Right
    static int[][] cardinal = new int[][]{{1, 0}, {-1, 0}, {0, -1}, {0, 1}};
    static int[][] compass = new int[][]{{-1, 0}, {-1, 1}, {0, 1}, {1, 1}, {1, 0}, {1, -1}, {0, -1}, {-1, -1}};
    /*
     *      7 0 1
     *      6 X 2
     *      5 4 3
     */

    /**
     * Going right into:
     * 7   - 1 if 7, 2, 0 / 5 if 4
     * J   - 3 if 2 /
     * '-' - 0 if 7, 1, 0 / 4 if
     */

    /* One extra Z somewhere, 370 Zs
................................╔═╗.........................................................................................................
................................╚╗╚═╗.......................................................................................................
..............................╔═╗║╔═╝.......................................................................................................
..............................╚╗║║║╔╗.......................................................................................................
..............................╔╝╚╝║║╚╗................................................╔═╗...................................................
...........................╔╗╔╝╔═╗║║╔╝........................╔═╗.....................╚╗║...................................................
...........................║║╚═╝╔╝║║╚╗╔╗......................╚╗║......................║║...................................................
..........................╔╝║╔═╗╚╗║║╔╝║║╔╗..................╔═╗║║......................║╚═╗╔╗.................╔╗............................
.......................╔╗.╚╗╚╝╔╝╔╝║║╚╗║║║╚╗.......╔╗........╚╗╚╝║......................╚╗╔╝║║..............╔╗.║║............................
.......................║║╔╗╚═╗║╔╝╔╝╚╗║║║║╔╝.......║║.........╚╗╔╝....................╔╗╔╝╚╗║╚╗.............║╚═╝╚╗...........................
......................╔╝║║╚══╝╚╝╔╝╔═╝╚╝╚╝╚╗╔╗╔╗...║║........╔╗║║╔═╗............╔╗....║║╚╗╔╝║╔╝.............╚══╗╔╝...........................
......................╚╗╚╝╔══╗╔╗╚╗║╔════╗╔╝║║║║.╔╗║║.╔╗╔╗╔══╝╚╝╚╝╔╝...........╔╝╚╗.╔═╝╚═╝╚═╝╚╗...............╔╝╚╗...........................
.......................╚╗╔╝╔═╝║╚╗╚╝╚═══╗╚╝╔╝╚╝╚╗║╚╝╚═╝║║║╚════╗╔═╝......╔╗....╚═╗╚╗╚═╗╔══════╝............╔╗╔╝╔╗╚╗..........................
........................╚╝X║╔═╝X╚═╗╔═══╝╔╗║╔═══╝╚══╗╔═╝║╚╗╔═╗╔╝╚╗.......║║...╔╗X╚╗╚╗X║╚═══╗╔╗...╔╗╔╗..╔═╗╔╝╚╝╔╝╚═╝.╔╗.......................
......................╔╗╔═╗╚╝╔═╗╔═╝╚═╗╔╗║║║║╔╗╔╗X╔═╝╚╗╔╝╔╝╚╗║║╔═╝╔╗.....║║..╔╝║╔╗╚╗╚╗║╔═══╝║╚═╗.║╚╝║╔╗║╔╝╚══╗║X╔╗╔═╝║╔═╗....................
......................║║║╔╝╔╗╚╗║╚═╗╔═╝║║║║║║║╚╝╚╗╚╗╔═╝║╔╝X╔╝╚╝║╔╗║╚╗╔═╗.║╚╗╔╝╔╝║║X╚╗║║╚══╗X║╔═╝.╚═╗╚╝║║║╔╗X╔╝╚╗║║║╔═╝║╔╝....................
....................╔╗║╚╝║╔╝╚═╝╚══╝║X╔╝╚╝╚╝╚╝╔══╝╔╝╚╗╔╝║╔╗╚╗╔╗║║╚╝╔╝╚╗║.╚╗║╚╗║X║║╔╗║║║╔══╝╔╝║╔╗╔╗X╚═╗╚╝╚╝╚╗╚╗╔╝║╚╝╚══╝╚╗....................
..................╔╗║║╚═╗║╚═══════╗║╔╝╔══════╝╔╗X╚═╗║║╔╝║╚╗╚╝║╚╝╔═╝╔╗║║╔╗║║╔╝╚╗║╚╝╚╝╚╝╚═╗X╚╗║║║║║X╔╗╚╗╔╗╔═╝X║║╔╝╔╗╔════╝....................
................╔╗║║║║X╔╝╚═╗╔╗╔╗╔╗║╚╝╔╝X╔══╗X╔╝╚╗╔═╝║║║X║╔╝X╔╝╔╗╚═╗║║║║║║║╚╝╔═╝╚═══╗╔╗╔═╝╔═╝║║╚╝║╔╝╚╗╚╝║╚═╗X║║║╔╝╚╝╔╗╔╗.....................
...............╔╝╚╝╚╝╚╗╚══╗║║║║╚╝║╚╗╔╝╔╗║╔╗╚═╝╔═╝╚═╗╚╝╚╗║╚══╝╔╝╚╗╔╝║║║╚╝║║╔═╝X╔═╗╔╗║║╚╝╔╗╚═╗║║╔═╝╚═╗║╔═╝╔═╝╔╝╚╝╚╗╔╗║╚╝╚╗....................
...............╚═════╗╚═══╝╚╝║╚═╗╚╗║╚╗║╚╝║║╔╗╔╝X╔═╗║╔╗╔╝║╔══╗║╔╗╚╝╔╝║╚═╗║║║╔═╗╚╗╚╝╚╝╚══╝╚╗╔╝║║╚╗╔╗╔╝║╚╗╔╝╔╗╚╗╔══╝║║║╔══╝╔╗..................
............╔═╗..╔╗╔╗╚══════╗?╗?╚╗╚╝╔╝║╔═╝╚╝╚╝╔╗╚╗║╚╝║╚╗╚╝╔═╝╚╝╚╗X╚╗║╔═╝╚╝╚╝╔╝╔╝╔═══╗╔═══╝╚╗╚╝╔╝║║╚╗║X║╚═╝╚═╝╚╗╔╗║║║║╔═╗║║..................
............╚╗║..║╚╝║╔╗╔════╝╔╝╔╗╚═╗║╔╝╚╗╔╗╔═╗║║╔╝╚═╗║╔╝╔╗╚═╗╔═╗╚╗╔╝║╚═══╗╔═╝X╚╗║╔══╝╚════╗║╔╗║╔╝║╔╝║╔╝╔══╗╔══╝║║║║║╚╝╔╝║║..................
............╔╝╚╗.╚═╗╚╝║╚═╗╔═╗╚╗║╚══╝╚╝╔═╝║║║╔╝║║╚══╗╚╝╚╗║║╔╗║╚╗╚═╝║╔╝╔═╗X║╚══╗X╚╝╚══╗╔════╝╚╝║╚╝╔╝╚╗║╚╗║╔╗╚╝╔═╗║║║╚╝╔═╝╔╝╚══╗...............
............╚═╗║.╔╗╚═╗║╔╗╚╝╔╝╔╝╚══╗╔═╗╚═╗║║║║X║╚╗╔╗╚═╗╔╝║║║║╚╗╚╗╔╗║╚╗╚╗║╔╝╔══╝╔╗x╔╗╔╝╚══╗╔═╗╔╝╔═╝╔╗║╚═╝╚╝╚╗╔╝╔╝║║║╔╗╚══╝╔╗╔═╝...............
............╔╗║║.║╚══╝║║║╔╗╚╗║╔╗╔╗╚╝?║╔╗║║╚╝╚╗╚╗║║║╔╗║╚╗║╚╝╚╗╚╗║║║║╔╝╔╝║╚╗║X╔╗║║╔╝╚╝╔═══╝║╔╝╚╗║╔╗║║╚═╗╔═══╝║╔╝╔╝╚╝║╚════╝╚╝╔╗...............
...........╔╝╚╝╚═╝╔══╗╚╝╚╝╚═╝╚╝║║║?╔═╝║╚╝╚═╗╔╝╔╝║║╚╝║║╔╝╚═╗╔╝X║║║╚╝╚╗╚╗╚═╝╚╗║╚╝║╚══╗╚╗╔╗╔╝║╔╗║║║╚╝╚╗╔╝╚╗╔╗X║╚╗╚═╗╔╝╔══╗╔╗╔╗║║...............
...........╚═╗╔═══╝╔╗╚════════╗║║║╔╝╔═╝X╔═╗║╚═╝╔╝╚═╗║║╚═╗╔╝╚═╗║╚╝╔══╝X╚═╗╔═╝╚═╗║╔╗╔╝╔╝║║╚╗║║║║║╚═╗╔╝╚═╗╚╝╚═╝╔╝╔═╝╚╗║╔═╝║╚╝║║║....╔╗.........
.........╔══╗╚╝╔══╗║╚╗╔╗╔╗╔═══╝╚╝╚╝╔╝X╔╗╚╗║║╔══╝╔═╗║╚╝╔═╝╚═╗╔╝╚═╗╚╗╔╗╔══╝╚╗╔╗X║║║║╚╗╚╗║║╔╝║║║║║╔╗║║╔═╗╚╗╔═══╝X╚═╗╔╝║║╔═╝╔═╝║║╔╗╔═╝║.........
.........╚═╗╚═╗╚═╗╚╝╔╝║║║║║╔╗╔═══╗╔╝╔╗║║╔╝╚╝╚═╗X╚╗╚╝╔╗╚╗╔╗╔╝╚╗╔╗║╔╝║║╚═══╗╚╝╚╗║╚╝║X╚╗║║║╚╗╚╝╚╝║║╚╝║╚╗║X║║X╔╗╔╗╔╗║╚═╝╚╝╔╗╚══╝╚╝╚╝╔═╝.........
........╔══╝╔╗╚╗X╚═╗║╔╝║║║╚╝╚╝╔╗X║╚╗║║║║╚══╗╔═╝╔╗╚══╝╚╗╚╝║╚╗╔╝║║║╚╗║║╔╗╔╗║╔══╝╚═╗╚╗╔╝╚╝╚╗╚╗╔══╝╚═╗╚╗║╚╗║╚╗║║║║║╚╝╔════╝║╔╗╔═╗╔══╝...........
........╚═══╝║╔╝X╔═╝║╚╗║║║X╔══╝╚╗╚╗║║║║║╔══╝╚╗X║║╔═╗╔═╝╔═╝X║║╔╝║║╔╝║║║║║╚╝║╔╗╔╗╔╝╔╝╚══╗╔╝╔╝╚═══╗X╚╗║║╔╝║╔╝║╚╝╚╝╔╗╚════╗╚╝╚╝X╚╝..............
..........╔══╝╚═╗╚═╗╚═╝║║╚╗╚═╗╔╗╚═╝║║║║║╚═══╗╚╗║║╚╗║╚═╗╚╗╔═╝║║╔╝║║╔╝║║║╚═╗║║║║║╚╗╚╗╔╗╔╝╚╗╚╗╔═══╝╔╗║╚╝║╔╝║╔╝╔═╗╔╝╚═════╝╔══╗╔╗...............
........╔╗╚════╗╚══╝╔═╗║╚╗║╔╗╚╝║╔═╗╚╝║║╚╗╔╗╔╝╔╝║║╔╝║╔╗║╔╝╚═╗║║╚╗║║║╔╝║║╔╗║╚╝╚╝╚╗║╔╝║║║╔╗║╔╝║╔═╗╔╝║║╔═╝╚╗╚╝╔╝X╚╝╔╗╔╗╔╗╔╗║╔═╝║║...............
.......╔╝╚═╗X╔╗║╔═══╝╔╝╚═╝║║╚╗╔╝║X╚╗╔╝║╔╝║║║╔╝X║║╚╗║║║║║╔╗X║║║╔╝║║║║X║║║║╚╗╔═══╝║║X║║║║╚╝╚╗║║╔╝║╔╝║║╔╗X╚╗╔╝╔═══╝║║╚╝╚╝╚╝║╔═╝╚══╗............
......╔╝╔═╗╚═╝║╚╝╔╗╔═╝╔══╗║╚╗║║╔╝╔╗║║╔╝╚╗║╚╝║╔═╝║╔╝║║║║║║╚╗║║║╚╗║║║║╔╝║║║╔╝╚╗╔══╝║╔╝║║╚═╗╔╝╚╝║╔╝╚╗║║║║╔╗║║╔╝╔╗╔═╝║╔══╗╔╗╚╝╔╗╔══╝.╔╗.╔╗......
......╚═╝.╚╗╔╗╚═╗║║╚╗╔╝╔╗║║╔╝║╚╝╔╝╚╝║║ZZ║║╔═╝╚═╗║╚╗╚╝║║╚╝Z║║║╚╗║║║║║║╔╝║║╚╗╔╝║╔══╝╚╗║╚╗Z╚╝Z╔═╝║╔═╝║║║║║╚╝║║╔╝╚╝╔═╝╚═╗╚╝╚══╝║║╔╗.╔╝║╔╝╚╗.....
.........╔╗╚╝╚═╗║║╚╗╚╝╔╝╚╝║╚╗║╔╗╚══╗║╚╗╔╝║║╔╗╔╗║║╔╝╔═╝╚╗╔╗║║║╔╝╚╝║║║║╚╗║║╔╝╚╗║╚═╗╔╗║╚╗╚╗╔══╝╔╗║║╔╗║║║║╚╗Z╚╝╚═══╝╔╗╔═╝╔═╗X╔╗╚╝║║.╚╗║║╔═╝.....
........╔╝╚════╝║╚╗║X╔╝╔═╗╚═╝╚╝╚═══╝╚═╝║╔╝║║║║║║╚╝╔╝╔═╗╚╝║║║║║Z╔╗║║║║Z╚╝║╚╗╔╝║╔═╝║║║╔╝╔╝╚╗╔╗║║║╚╝║║║║║╔╝╔═════╗╔╝╚╝╔╗╚╗╚═╝║╔═╝╚══╝╚╝║.......
........║╔═══╗╔╗╚╗║║╔╝╔╝X╚══╗╔╗╔═╗╔══╗╔╝╚╗║║║║║╚═╗╚═╝╔╝╔╗║║║║╚═╝║╚╝║║╔══╝╔╝╚╗║╚╗╔╝║║╚╗║Z╔╝║║║║╚╗╔╝║║║╚╝Z╚═══╗X╚╝╔╗X║╚╗║╔══╝║╔════╗╔╗║.......
.......╔╝╚╗╔═╝║╚╗╚╝╚╝╔╝╔════╝║║║╔╝║╔═╝╚═╗║║║║║║╔═╝╔╗╔╝╔╝║║║║║╔═╗╚═╗║║║╔═╗║╔═╝║╔╝╚╗║║╔╝╚╗╚╗║║║║╔╝╚═╝║║╔═════╗╚═══╝╚╗║╔╝║╚╗╔═╝╚═══╗╚╝╚╝.......
.......╚══╝╚══╝X╚═══╗╚╗║╔╗╔═╗║╚╝╚═╝╚═══╗╚╝╚╝║║║║Z╔╝╚╝╔╝╔╝║║║║╚╗╚╗╔╝║║║║╔╝║╚═╗║║╔╗║║║╚╗╔╝Z╚╝║║║╚╗╔══╝║╚╗╔══╗╚══════╝║║X║╔╝╚╗╔════╝...........
.........╔═══╗╔═════╝╔╝╚╝╚╝X║║╔═══╗╔═══╝╔╗╔╗╚╝║╚╗╚╗╔╗║Z╚╗║╚╝╚╗║Z║╚╗║║╚╝║╔╝╔═╝║║║╚╝║╚╗║╚═╗╔═╝║║╔╝╚╗╔╗╚╗╚╝╔═╝╔╗X╔══╗X║╚╗║║╔╗║╚═╗X╔╗╔╗.........
.........╚══╗║╚╗╔╗╔═╗║╔╗╔╗╔╗╚╝╚══╗║╚════╝╚╝╚═╗║╔╝Z╚╝╚╝╔═╝╚╗Z╔╝╚╗║╔╝╚╝╔═╝╚╗╚═╗║║╚═╗║╔╝║╔╗║║╔╗║╚╝╔╗║║╚═╝╔╗╚══╝╚╗║╔═╝╔╝╔╝║╚╝╚╝╔═╝╔╝╚╝╚═╗.......
.......╔════╝║X╚╝╚╝X║║║╚╝╚╝╚══╗╔═╝╚══════╗╔╗╔╝╚╝╔╗╔═╗Z╚╗╔╗╚╗╚╗╔╝║╚═╗╔╝╔╗╔╝Z╔╝║╚═╗║║╚╗║║╚╝║║║║Z╔╝║╚╝╔╗Z║║Z╔═══╝║║╔╗╚╗╚╗║╔═══╝╔╗║╔════╝.......
.......╚════╗╚═╗╔╗╔═╝║╚╗╔╗╔╗╔╗║╚════════╗╚╝║╚╗Z╔╝╚╝╔╝╔╗╚╝╚╗╚╗║╚╗║╔═╝╚╗║║║╔═╝╔╝╔═╝║╚╗║╚╝╔╗║║║╚╗╚╗╚══╝║╔╝╚═╝╔╗X╔╝╚╝╚═╝╔╝║║X╔╗╔╝╚╝╚════╗.......
.......╔╗╔═╗╚═╗╚╝╚╝╔╗╚╗║║║║╚╝║╚═══════╗╔╝╔╗╚═╝╔╝╔╗╔╝Z║║Z╔═╝╔╝║╔╝║║╔╗Z╚╝║║╚═╗╚╗╚═╗╚╗║╚══╝║╚╝╚╗║Z╚═══╗╚╝╔═══╝╚═╝╔════╗╚═╝╚═╝╚╝╔═══╗╔══╝.......
.......║║╚╗║╔╗╚╗╔═╗║╚╗║║║╚╝╔╗╚═══════╗╚╝╔╝╚╗╔═╝╔╝╚╝╔╗║╚╗║╔╗╚╗║╚╗║╚╝╚╗Z╔╝║╔═╝╔╝╔═╝╔╝╚╗╔╗╔╝Z╔═╝║╔════╝╔╗║╔═══╗╔╗╚═══╗╚╗╔══╗╔═╗╚══╗╚╝..........
.......║╚═╝╚╝╚═╝║╔╝║X║║╚╝╔═╝╚═══════╗╚═╗║╔╗║╚═╗║Z╔╗║║║╔╝╚╝╚╗║║╔╝╚╗╔═╝╔╝╔╝╚═╗║Z╚═╗╚═╗║║║║Z╔╝╔╗║╚╗╔╗╔╗║║║╚═╗X╚╝║╔═╗╔╝X║╚═╗╚╝X╚╗╔╗╚══╗.........
.......║╔═╗╔═══╗║╚╗╚╗║║╔═╝╔╗╔══╗╔══╗╚══╝║║╚╝╔═╝╚═╝╚╝╚╝╚═══╗║║║╚═╗╚╝╔╗╚╗╚╗╔═╝╚═╗Z╚╗╔╝║║║╚╗╚═╝╚╝╔╝║║║╚╝║║╔╗╚══╗╚╝╔╝╚═╗║╔╗╚═══╗║║║╔╗╔╝.........
.......╚╝.║╚╗╔═╝╚╗╚╗║╚╝╚══╝╚╝╔╗╚╝╔╗╚═══╗║║╔╗╚╗╔════╗╔═╗╔══╝║║║╔╗╚══╝╚╗╚╗║╚═╗╔╗╚╗╔╝║Z║║╚╗╚═╗Z╔╗╚╗║╚╝╔╗╚╝║╚═══╝╔╗╚╗╔═╝╚╝║╔╗╔╗║║║╚╝║║..........
.........╔╝╔╝╚╗╔═╝╔╝║╔═╗╔╗╔══╝╚═╗║║╔═══╝║║║║Z║╚═══╗║║Z║║╔═╗║║║║║╔╗╔╗╔╝╔╝║╔═╝║╚═╝╚╗╚╗╚╝╔╝╔═╝╔╝║Z╚╝Z╔╝║╔╗╚═════╝║X║╚══╗╔╝║╚╝╚╝║║╔╗╚╝..........
.........╚═╝╔═╝╚╗X╚═╝╚╗╚╝╚╝╔╗╔═╗╚╝╚╝╔╗Z╔╝╚╝╚═╝╔═══╝║╚╗║╚╝╔╝╚╝╚╝╚╝║║║╚╗╚╗║╚═╗╚═══╗╚╗║╔╗║╔╝╔╗╚╗║╔╗╔╗╚╗╚╝║╔══════╝╔╝╔═╗║╚╗╚╗X╔═╝╚╝╚╗...........
..........╔╗╚╗╔╗║XX╔══╝╔══╗║║╚╗╚╗╔═╗║║╔╝╔╗╔═╗╔╝╔══╗╚╗║║╔╗╚╗╔═╗╔╗Z║║║╔╝╔╝║╔═╝╔╗╔═╝Z╚╝║║╚╝╔╝╚═╝╚╝╚╝╚═╝╔╗║╚═╗╔╗╔╗X╚═╝X╚╝X╚╗╚╗║╔╗╔╗╔╝...........
.........╔╝╚═╝║╚╝╔╗╚═══╝╔╗╚╝╚═╝X╚╝X╚╝╚╝╔╝╚╝Z║╚═╝╔═╝Z╚╝║║╚╗║╚╗╚╝╚╗╚╝╚╝╔╝╔╝╚═╗║╚╝╔════╝╚═╗╚════╗╔╗╔╗╔═╝║║╔╗╚╝╚╝╚═══╗X╔═╗╔╝╔╝╚╝║║║╚╗...........
.........╚╗╔═╗║╔═╝║╔╗╔╗╔╝╚═╗╔╗X╔═══════╝╔╗╔═╝╔══╝╔══╗Z╚╝╔╝╚═╝╔╗╔╝Z╔╗Z╚╗║╔══╝╚═╗╚═╗╔╗╔╗╔╝Z╔╗Z╔╝║╚╝╚╝╔═╝╚╝╚═══╗╔╗╔╗╚╗╚╗║╚═╝╔╗X╚╝║╔╝...........
..........╚╝.╚╝╚═╗║║╚╝╚╝╔═╗╚╝╚╗╚════════╝║║╔╗╚╗╔═╝╔╗╚═╗Z╚╗╔╗╔╝╚╝╔╗║╚╗Z║║╚╗╔╗╔═╝╔═╝║╚╝║║Z╔╝╚═╝╔╝╔╗╔═╝╔══════╗╚╝║║╚╗╚╗║║X╔╗║╚══╗╚╝............
.............╔═══╝║║╔╗╔╗║╔╝╔╗╔╝╔════╗╔═╗╔╝╚╝╚╗╚╝╔╗║╚═╗╚═╗╚╝║╚═══╝╚╝╔╝Z║║Z║║║╚═╗║╔╗║╔═╝╚╗╚════╝Z║╚╝╔═╝╔╗╔╗╔╗╚═╗╚╝X╚═╝║╚═╝╚╝╔══╝..............
.............╚═══╗║╚╝║║║║╚═╝║╚╗╚═╗╔╗╚╝Z╚╝╔╗╔═╝╔═╝║╚═╗╚══╝╔╗╚╗╔═╗╔╗╔╝ZZ╚╝Z║║║╔═╝║║╚╝╚╗╔╗╚══╗╔╗╔╗╚══╝╔═╝╚╝╚╝╚══╝╔╗╔╗╔═╝╔═╗╔╗╚══╗..............
........╔╗..╔════╝╚╗X╚╝╚╝X╔╗╚╗╚═╗╚╝╚╗╔═══╝║║╔╗╚═╗╚══╝╔╗╔═╝║Z╚╝Z╚╝║╚══╗ZZZ║║║║ZZ╚╝╔═╗╚╝╚══╗║║║║║╔╗╔═╝╔═════╗╔╗X║╚╝╚╝╔═╝X╚╝╚═══╝..............
.......╔╝║..╚═════╗║╔╗╔╗╔╗║╚╗║╔╗║╔╗╔╝║╔═══╝╚╝╚═╗╚╗╔══╝╚╝╔╗╚═══╗ZZ╚╗╔═╝ZZZ╚╝╚╝ZZZZ╚╗║╔╗╔══╝╚╝║║║║║║╔╗║╔════╝║╚╗║╔╗╔╗╚╗╔╗X╔╗╔╗╔╗╔═╗...........
.......╚╗╚╗╔╗╔╗╔══╝║║╚╝║║║╚╗║╚╝║╚╝╚╝╔╝╚═══╗Z╔═╗╚╗╚╝╔╗╔╗╔╝║╔╗╔╗╚══╗║║ZZZZZZZZZZZZ╔╗║║║║╚═╗╔═╗╚╝║║║╚╝║║╚═╗╔╗X║╔╝║║╚╝╚═╝║╚╗║║║╚╝║║╔╝...........
........╚╗╚╝║║╚╝╔═╗║╚╗╔╝║║╔╝╚╗╔╝╔══╗║╔════╝╔╝╔╝Z╚══╝╚╝╚╝Z╚╝╚╝╚═╗╔╝║║ZZZZZZZZZZZ╔╝╚╝║║║╔╗╚╝Z╚═╗╚╝╚╗X╚╝╔╗╚╝╚═╝╚═╝╚══╗╔╗╚╗╚╝║║╔╗╚╝╚═╗..........
.........╚═╗║╚══╝╔╝╚═╝║╔╝║╚═╗║║╔╝╔╗╚╝╚═╗Z╔╗╚╗║Z╔╗╔═════════╗╔╗Z╚╝Z╚╝ZZZZZZZZZZZ╚══╗╚╝║║╚══╗╔╗╚╗╔╗║╔══╝╚═╗╔╗╔══════╝║╚═╝╔╗╚╝║║╔╗╔╗╚╗.........
......╔══╗X║║╔╗X╔╝╔╗╔╗╚╝╔╝╔═╝║╚╝╔╝╚═╗╔╗╚╗║║Z║╚╗║╚╝╔═╗╔╗╔╗╔╗╚╝╚═══╗ZZZZZZZZZZZZ╔╗╔═╝╔═╝║╔═╗╚╝╚╗║║╚╝╚════╗╚╝║╚══╗╔═══╝╔╗╔╝╚══╝║║║║╚╗║.........
......╚═╗╚═╝╚╝╚═╝╔╝╚╝╚═╗╚╗╚═╗╚╗╔╝╔═╗╚╝╚╗╚╝╚═╝╔╝║╔═╝Z╚╝╚╝║║╚══════╝ZZZZZZZZZZ╔═╝║╚═╗╚═╗╚╝Z╚══╗╚╝╚╗╔╗╔╗╔╗╚═╗╚╗╔╗╚╝╔═╗╔╝╚╝╔═══╗║║╚╝.╚╝.........
........╚════╗╔╗╔╝╔═══╗╚╗╚══╝╔╝╚╗╚╗╚═╗Z╚╗╔═╗╔╝Z║║╔╗╔═══╗║╚══╗ZZZZZZZZZZZZ╔╗Z╚═╗║╔═╝╔═╝╔╗Z╔╗Z║╔═╗╚╝╚╝╚╝╚══╝X╚╝║╔═╝╔╝╚═══╝╔╗╔╝║╚╗.............
........╔══╗X╚╝╚╝X╚══╗╚═╝╔╗╔╗╚═╗╚═╝╔═╝╔╗╚╝╔╝╚══╝╚╝╚╝╔══╝╚═╗╔╝ZZZZZZZZZZZZ║╚══╗║║╚═╗║╔╗║╚═╝╚═╝╚╗╚══════╗╔═══╗X║╚═╗╚╗╔╗╔═╗║║╚╗╚╗╚╗............
........╚═╗║╔╗XX╔════╝╔══╝╚╝╚╗╔╝X╔═╝╔═╝╚╗Z╚╗╔╗╔═╗╔═╗╚════╗╚╝ZZZZZZZZZZZZZ╚╗╔╗╚╝╚══╝╚╝╚╝╔╗╔╗╔╗╔╝╔╗╔╗Z╔╗╚╝╔═╗╚╗║╔╗╚╗╚╝║╚╗╚╝╚═╝X╚╗╚╗...........
....╔╗╔═╗╔╝╚╝║╔╗╚═╗╔══╝╔═════╝║X╔╝╔═╝╔══╝╔╗║║║╚╗╚╝╔╝╔╗╔══╝ZZZZZZZZZZZZZZZZ╚╝╚═╗╔╗╔═╗╔═╗║║║╚╝╚╝╔╝╚╝║╔╝╚═╗╚╗╚═╝╚╝╚╗╚╗X╚╗╚╗╔╗╔╗╔╗╚═╝...........
..╔╗║║║╔╝╚══╗╚╝╚╗X╚╝╔═╗╚╗╔═╗╔╗╚═╝╔╝╔═╝╔══╝║║║║╔╝╔╗╚═╝║╚═══╗╔╗╔╗ZZZZZZZZZZZ╔══╗╚╝║╚╗╚╝╔╝║╚╝╔═══╝╔═╗╚╝╔═╗╚╗╚══╗X╔╗╚╗╚═╗╚═╝║║║╚╝╚════╗.........
╔═╝╚╝╚╝╚═══╗╚══╗║╔╗X╚╗║X╚╝X╚╝║╔═╗╚╗╚══╝╔╗╔╝║║║╚═╝╚══╗╚════╝║╚╝║ZZZZZZZZZZZ╚═╗╚══╝╔╝╔╗║╔╝╔═╝╔╗╔╗║Z╚╗╔╝Z╚╗╚═══╝╔╝║X╚══╝X╔═╝╚╝╔══╗╔══╝.........
╚═╗╔═╗╔═╗╔╗╚═══╝╚╝╚═╗║║╔═╗X╔═╝║╔╝╔╝╔╗╔╗║║╚╗╚╝║╔═════╝╔═════╝╔╗╚╗ZZZZZZZZZZZZ╚═╗╔╗╚╗║╚╝╚╗╚══╝╚╝║║╔═╝╚╗╔═╝╔══╗X╚╗╚══════╝╔╗╔╗╚╗X╚╝............
..╚╝.║║╔╝║╚═╗╔═╗╔╗╔╗╚╝║╚╗╚╗╚══╝║╔╝╔╝╚╝╚╝╚═╝╔╗╚╝╔════╗╚╗╔══╗╔╝╚═╝ZZZZZZZZZZZZZ╔╝║╚╗║║╔═╗║╔═════╝║║╔╗╔╝╚══╝╔═╝╔╗║╔══════╗║╚╝╚═╝XX╔══╗.........
.....╚╝╚═╝X╔╝║╔╝║║║║╔╗╚╗╚╗║╔╗╔╗╚╝X╚╗╔╗Z╔╗╔╗║╚══╝╔══╗║╔╝╚═╗║╚═╗╔╗ZZZZZZZZZZZZ╔╝╔╝╔╝║║╚╗╚╝╚═════╗║║║╚╝╔╗Z╔╗╚══╝╚╝╚═════╗║╚═════╗X╚╗╔╝.........
......╔══╗X╚═╝╚═╝║║╚╝╚╗╚═╝╚╝╚╝╚╗X╔╗╚╝╚═╝╚╝╚╝╔═══╝╔╗╚╝║╔══╝╚══╝║║╔╗ZZZZZZZZZZ╚╗╚╗╚═╝╚═╝Z╔══╗╔═╗╚╝║║╔═╝║╔╝╚═╗╔╗╔═══════╝╚══════╝╔╗║║..........
..╔╗..╚═╗╚╗╔═════╝║╔══╝╔╗╔════╗║╔╝║╔═══╗╔╗╔╗╚═══╗║╚══╝╚══╗╔╗╔╗║║║║╔╗ZZZZZZZZZ║╔╝╔═════╗╚═╗║╚╗╚═╗╚╝║╔╗╚╝╔═╗╚╝║╚╗X╔╗╔╗╔╗X╔╗X╔╗╔╗║╚╝╚═╗........
.╔╝╚══╗X╚╗║╚══════╝╚═╗╔╝║║╔══╗║║╚╗╚╝╔═╗╚╝║║╚╗╔═╗╚╝╔══════╝║╚╝║║║║║║╚╗ZZ╔╗ZZZZ╚╝Z╚════╗╚══╝╚╗║╔╗╚═╗║║╚╗╔╝╔╝╔╗╚═╝╔╝╚╝╚╝╚═╝╚═╝║║╚╝╔═══╝........
.╚═══╗║╔╗║║╔╗╔═══╗X╔╗║╚╗║║╚═╗╚╝║X╚═╗║╔╝╔╗╚╝╔╝║Z║╔╗╚═╗╔╗╔╗Z║╔═╝║╚╝╚╝╔╝ZZ║║ZZZZ╔═╗Z╔╗╔╗╚═══╗╔╝╚╝║╔═╝╚╝Z╚╝Z╚═╝╚═══╝╔═════╗╔╗╔╗╚╝╔╗║╔══╗........
....╔╝╚╝╚╝╚╝╚╝╔═╗╚═╝╚╝╔╝╚╝╔╗╚═╗╚═╗X╚╝╚═╝╚═╗╚═╝╔╝║║╔╗╚╝╚╝╚╗║║╔╗║╔══╗║ZZZ║╚╗ZZZ║╔╝╔╝╚╝╚════╝╚╗╔╗║║╔╗Z╔════╗╔══════╝╔═══╗╚╝╚╝╚══╝╚╝║╔═╝........
....║╔═╗╔═╗╔╗╔╝X╚═╗╔═╗╚╗X╔╝╚╗╔╝╔╗╚══════╗╔╝╔╗Z║╔╝╚╝║╔═╗╔═╝║╚╝╚╝╚═╗║║ZZ╔╝╔╝ZZZ║╚═╝╔╗╔══════╗╚╝╚╝╚╝╚╗╚═══╗╚╝╔╗X╔╗╔╗║╔═╗╚╗╔╗╔╗╔════╝╚═╗........
....╚╝╔╝╚╗╚╝║╚═╗╔═╝║╔╝╔╝╔╝╔╗╚╝╔╝║╔═════╗║╚═╝╚╗║╚══╗║╚╗║╚═╗║╔══╗╔═╝╚╝╔═╝╔╝Z╔═╗╚═══╝╚╝╔═════╝╔╗╔═╗╔╗╚╗Z╔╗║╔═╝╚═╝╚╝║║║X╚╗╚╝║║╚╝╔══════╝........
.....╔╝╔╗║╔╗╚╗╔╝╚╗╔╝║╔╝X╚═╝╚╗╔╝╔╝║╔═╗╔═╝╚═╗╔╗║║╔╗╔╝╚╗║╚═╗║║╚═╗║╚══╗Z╚═╗║╔╗╚╗╚╗Z╔╗ZZZ╚═══╗╔═╝║║z║║╚╗╚╗║║╚╝╔╗╔╗╔══╝║╚═╗║╔═╝║╔═╝X╔══╗..........
.....╚╗║╚╝║╚╗║╚═╗║╚╗╚╝╔═══╗╔╝╚╗╚═╝╚╗║╚═╗╔╗╚╝║║║║║╚═╗║╚═╗╚╝║╔═╝╚═══╝╔══╝╚╝╚╗║╔╝Z║╚╗Z╔╗╔╗Z╚╝Z╔╝╚╗╚╝Z╚╗╚╝╚══╝╚╝║║X╔╗║╔═╝╚╝X╔╝╚╗╔╗║╔═╝╔╗.╔╗.....
.....╔╝╚═╗╚╗╚╝╔═╝╚═╝╔╗╚══╗║╚══╝╔═══╝║╔═╝║║╔╗╚╝╚╝║╔═╝╚══╝Z╔╝║╔╗╔══╗Z╚════╗╔╝║║╔╗╚╗║╔╝╚╝╚════╝╔╗╚╗╔╗Z╚╗╔═════╗║║╔╝╚╝╚╗╔═══╝╔╗╚╝╚╝╚══╝╚═╝╚╗....
.....╚═╗╔╝.╚═╗║╔═╗X╔╝║╔╗╔╝╚╗╔╗X╚╗╔═╗║║╔═╝╚╝╚╗╔╗Z╚╝Z╔╗╔╗╔╗╚╗║║║║╔═╝Z╔═╗╔╗║║╔╝║║║╔╝║║╔══╗╔═══╗║╚╗║║╚══╝║╔═══╗║║║╚═╗╔═╝║╔═══╝╚═╗╔═════════╝....
......╔╝╚╗..╔╝║╚╗╚╗╚╗╚╝║╚╗╔╝║║╔╗║║X║║║║╔═══╗╚╝╚═══╗║║║╚╝╚═╝╚╝║║║╔═╗╚╗║║║║║╚╗╚╝║║╔╝╚╝╔═╝║╔══╝╚╗║║╚════╝╚══╗╚╝╚╝X╔╝╚══╝╚═════╗║╚═════╗........
......╚╗╔╝..║╔╝X╚╗║X╚═╗╚═╝╚═╝║║║╚╝╔╝╚╝║║╔╗Z╚══════╝║║║╔══╗╔══╝║╚╝╔╝╔╝╚╝║║╚═╝╔═╝║║Z╔╗╚══╝╚═══╗║║║Z╔╗╔╗Z╔═╗╚╗╔╗╔═╝╔╗╔╗╔═══╗╔═╝║╔═════╝........
.......╚╝.╔╗╚╝╔══╝║╔══╝╔═╗╔═╗╚╝╚╗X╚╗Z╔╝╚╝╚╗╔══════╗║║╚╝╔═╝╚══╗║╔═╝╔╝╔═╗╚╝╔══╝╔╗║╚╗║║╔╗╔═══╗Z╚╝╚╝╔╝╚╝╚╗╚╗║╔╝║║╚╗╔╝╚╝║╚══╗╚╝X╔╝╚════════╗.....
..........║║╔╗╚══╗╚╝╔══╝X╚╝X╚══╗╚═╗╚═╝╔══╗╚╝╔══╗╔═╝║║╔╗╚╗╔╗╔═╝║╚╗Z╚═╝Z║╔═╝╔╗╔╝║║╔╝║║║║╚══╗╚═╗╔╗╔╝╔══╗╚═╝╚╝X║║╔╝╚══╗║╔══╝X╔╗╚═╗╔═╗╔╗╔══╝.....
..........║╚╝╚╗╔╗╚═╗╚╗╔═╗X╔╗╔═╗║╔╗╚══╗╚═╗║╔╗╚═╗╚╝╔╗║║║╚╗╚╝║╚╗╔╝╔╝╔╗╔╗╔╝╚══╝║╚╗╚╝║Z║║║║Z╔╗║╔═╝║╚╝╔╝╔╗╚═╗╔═══╝╚╝╔╗╔╗║║╚╗╔══╝╚═╗╚╝╔╝║╚╝........
..........╚╗╔╗╚╝║X╔╝╔╝╚╗╚╗║║╚╗║╚╝╚═╗Z╚╗╔╝╚╝╚══╝╔═╝║║║║╔╝Z╔╝╔╝║╔╝Z║║║║╚═╗╔═╗╚╗╚╗╔╝╔╝║║╚╗║║║╚╗Z╚══╝Z║║╔╗╚╝╔═══╗╔╝╚╝╚╝╚═╝║╔═══╗╚═╗╚╗╚╗.........
..........╔╝║║╔╗╚═╝╔╝╔╗╚╗╚╝║╔╝╚════╝╔╗╚╝╔╗Z╔═╗Z║╔═╝║║║║╔╗╚╗║╔╝╚╗╔╝║║╚═╗║║Z╚═╝╔╝╚╗╚╗║║╔╝║║╚╗╚╗╔╗╔══╝╚╝╚╗Z╚══╗╚╝╔╗╔╗╔╗╔╗║╚══╗║╔═╝╔╝╔╝.........
..........╚╗║║║╚╗╔╗║X║╚╗╚═╗╚╝╔══════╝╚══╝╚╗╚╗╚╗║║Z╔╝║║╚╝╚╗║║║╔═╝╚╗║╚═╗╚╝╚╗╔╗╔╝╔═╝╔╝║║╚═╝╚╗║╔╝║║╚═╗╔══╗╚╗╔═╗╚══╝╚╝╚╝╚╝╚╝╔══╝╚╝╔╗╚═╝..........
...........╚╝║║.╚╝║╚╗╚╗╚══╝╔╗║╔═══════════╝╔╝╔╝║║╔╝╔╝╚══╗║║╚╝╚╗╔╗║║╔╗╚══╗╚╝║║╔╝╔╗║╔╝╚═══╗╚╝╚╗║║╔╗╚╝╔═╝╔╝╚╗╚════════╗╔═╗╚══╗╔╗║╚═╗.╔╗........
.............╚╝.╔═╝╔╝X╚══╗╔╝╚╝╚════════╗╔╗Z║╔╝╔╝╚╝╔╝╔═══╝║║╔══╝║║║║║║Z╔═╝╔═╝║║╔╝║║╚╗╔╗╔╗╚═╗╔╝║║║║╔═╝╔╗╚═╗╚══╗╔╗X╔╗X╚╝X╚╗╔═╝║╚╝╔╗║╔╝║........
................╚══╝X╔═══╝╚╗╔═════════╗╚╝╚═╝╚╗╚╗╔═╝Z╚══╗╔╝║╚╗╔═╝║║║║║╔╝╔╗║╔╗║║╚╗║║╔╝║║║║Z╔╝╚╗║║║║╚╗╔╝║╔╗╚══╗╚╝╚╗║╚═╗╔╗X╚╝╔═╝╔═╝╚╝║╔╝╔═╗.....
..............╔╗..╔══╝╔══╗╔╝╚╗╔╗╔╗╔══╗╚═╗╔══╗║╔╝╚══╗╔═╗║║╔╝╔╝╚═╗║║║║║╚═╝║╚╝╚╝║╔╝║║╚╗║║║╚╗╚═╗║║║║╚╗║║Z╚╝╚══╗║╔═╗╚╝╔═╝║╚╗╔╗╚═╗║X╔╗╔╝║╔╝╔╝.....
..............║║.╔╝╔═╗║╔═╝╚╗X║║╚╝╚╝╔╗╚╗╔╝╚═╗╚╝║╔═══╝╚╗║║║║╔╝╔╗╔╝╚╝╚╝║╔╗╔╝╔═══╝╚╗║╚╗║║║╚╗║╔═╝╚╝║║╔╝╚╝╔╗╔═══╝╚╝X╚══╝╔═╝╔╝║╚═╗║║╔╝╚╝╔╝╚╗║╔╗╔╗..
..............║╚╗╚═╝X╚╝║╔╗╔╝╔╝║╔═══╝╚═╝╚═══╝╔═╝╚══╗Z╔╝╚╝║║║╔╝║╚════╗║║║╚╗║╔╗╔╗Z║╚═╝║║║╔╝║╚══╗╔╝║║╔══╝╚╝╔═╗╔╗╔═════╝╔═╝X║╔═╝║║║╔══╝╔╗║╚╝╚╝╚╗.
..............╚╗╚══╗╔═╗╚╝╚╝X╚═╝╚════╗╔╗╔╗╔╗Z╚═╗╔══╝╔╝╔══╝║║║╔╝╔╗╔═╗║║║╚╗║╚╝║║║╔╝╔═╗║║║╚╗╚═╗╔╝║╔╝║╚═╗╔═╗║╔╝║╚╝╔╗╔═╗╔╝╔══╝╚══╝╚╝╚═══╝╚╝╔════╝.
.............╔╗╚══╗║╚╗╚════╗╔╗╔╗╔═══╝║║║║║╚╗╔╗║║╔═╗╚╗║╔═╗║╚╝╚╗║║╚╗║║║╚╗╚╝╔═╝║╚╝╔╝Z╚╝║║╔╝╔═╝╚╗╚╝╔╝╔╗║╚╗║║╚═╝╔═╝╚╝X║╚═╝╔╗╔══╗╔════════╗╚══╗...
............╔╝║╔╗X║║X╚════╗╚╝╚╝╚╝╔═══╝╚╝║║╔╝║║║║╚╗║╔╝║║╔╝╚══╗║║║╔╝║║╚╗╚═╗║╔╗║╔═╝╔╗╔╗║║╚╗║╔╗Z╚╗╔╝Z║║╚═╝╚╝Z╔╗╚════╗╚╗╔═╝║╚═╗║╚╗╔═════╗╚╗╔╗║...
............╚╗╚╝╚═╝║╔═════╝╔═════╝X╔════╝║║╔╝║║║╔╝║║╔╝║╚╗╔╗╔╝║║║║╔╝╚╗╚╗╔╝║║║║╚═╗║╚╝║║║╔╝║║║╔╗║╚═╗║╚╗╔╗╔══╝╚╗╔═══╝╔╝║╔╗╚╗╔╝╚╗╚╝╔╗╔═╗║.╚╝╚╝...
.............╚╗╔══╗║╚══════╝╔══════╝Z╔╗╔╗║║║╔╝║║╚╗║║║Z║╔╝║║╚╗║║║║║ZZ║╔╝╚╗║║║╚╗╔╝║╔═╝║║╚╗║║║║║╚╗╔╝║╔╝║║╚═══╗╚╝╔══╗╚╗╚╝╚╗║╚╗╔╝╔╗║║╚╗╚╝........
..............╚╝╔╗║║X╔╗╔╗X╔═╝╔╗╔═╗╔╗╔╝║║║║║║╚╗║║╔╝║║║╔╝╚╗║╚╗║╚╝║║╚╗╔╝║╔╗║╚╝╚╗║║╔╝║╔╗║╚╗║║║╚╝╚╗║╚╗║╚╗║╚╗╔═╗╚══╝╔╗╚╗╚╗╔═╝║╔╝║╔╝║║╚╗╚╗.........
..........╔═╗╔╗╔╝╚╝╚═╝╚╝╚═╝╔╗║║╚╗╚╝║╚╗║║║║║╚╗╚╝║╚╗║║║║X╔╝╚╗║╚═╗║╚╗║║╔╝║║╚╗╔╗║║║╚╗║║║╚╗║║║║╔═╗║╚╗╚╝X║║X║╚╗║╔╗╔═╝║╔╝X║╚═╗║║╔╝╚╗║╚╗║╔╝.........
..........╚╗╚╝╚╝╔═════╗╔╗╔╗║║║╚═╝X╔╝╔╝╚╝║║╚╗║╔═╝╔╝║║║║╔╝╔╗║║╔═╝║╔╝║║╚═╝╚╗╚╝║║║╚═╝╚╝╚╗║╚╝║║╚╗╚╝╔╝╔══╝╚╗╚╗║╚╝║╚═╗║║╔═╝╔╗║╚╝╚═╗║║╔╝╚╝..........
...........╚════╝X╔╗╔═╝║║║║║╚╝╔═══╝╔╝X╔═╝║X╚╝║╔═╝╔╝║║║╚╗║║║║╚╗X╚╝X╚╝╔╗╔═╝╔═╝║║╔═╗X╔═╝║╔═╝╚╗║╔╗╚╗╚══╗╔╝╔╝╚═╗║╔╗║╚╝╚╗╔╝╚╝╔╗╔╗╚╝║╚═╗...........
..........╔═══════╝╚╝╔═╝╚╝║║╔═╝╔══╗║╔╗║╔╗║╔══╝╚═╗║╔╝║╚╗║║║║╚╗╚══╗╔══╝╚╝╔╗╚═╗╚╝║╔╝╔╝╔╗║║╔╗╔╝╚╝║╔╝╔══╝╚╗╚╗╔╗║║║║╚═╗╔╝╚═╗X║╚╝╚═╗║╔═╝...........
..........╚═╗╔═╗╔╗╔╗╔╝╔╗╔═╝║║╔╗║╔═╝║║║║║║║║╔═╗╔═╝╚╝╔╝╔╝║║╚╝X╚╗╔═╝╚══╗╔╗║║╔╗╚══╝╚╗║╔╝║║║║║╚╗╔═╝╚╗╚╗╔╗╔╝X╚╝║║╚╝║╔═╝║╔═╗╚╗╚╗╔══╝║╚╗............
..........╔═╝║X║║║║║║╔╝╚╝╔╗║╚╝╚╝╚═╗╚╝║║║║║╚╝╔╝╚══╗X╚╗║╔╝╚═╗╔═╝╚═══╗╔╝║║║║║║╔╗╔╗╔╝║╚╗║║║║║╔╝╚╗╔═╝╔╝║║╚═══╗║║╔═╝╚═╗║╚╗╚╗╚═╝║╔╗X╚╗║............
..........║╔╗║╔╝║║║╚╝╚╗╔╗║║║╔══╗╔╗╚╗╔╝║║╚╝X╔╝╔╗╔═╝╔═╝║╚╗╔╗║╚╗╔╗╔══╝║╔╝║║║║║║║║║║╔╝╔╝║║║║║╚╗╔╝╚═╗╚╗║║╔═╗╔╝║║║╔╗╔═╝╚═╝X║╔╗╔╝║║╔╗╚╝............
..........╚╝║║╚═╝╚╝╔╗╔╝║║║╚╝║╔╗╚╝╚═╝╚╗║║╔══╝╔╝║╚═╗╚═╗║╔╝║║║╔╝║║╚═╗╔╝╚╗╚╝║║║║║║║║╚╗║X╚╝╚╝╚╗║║╔╗╔╝X╚╝║╚╗║╚╗║║║║║╚═════╗╚╝╚╝╔╝║║╚══╗...........
............║║X╔═══╝╚╝╔╝║║X╔╝║╚╗╔╗╔╗╔╝║║╚╗╔╗║╔╝╔╗╚╗X║║╚╗║║║╚╗║║╔═╝║╔═╝X╔╝║║║║║║║X║╚═══╗╔═╝║║║╚╝╔═══╝╔╝║╔╝╚╝╚╝║╔╗╔═╗╔╝╔╗╔╗╚╗╚╝╔═╗╚╗..........
............╚╝╔╝╔═╗╔╗╔╝X║║╔╝╔╝╔╝║╚╝║╚╗╚╝╔╝║║║║╔╝╚╗╚╗║╚╗║║║╚╗╚╝║╚═╗║╚══╗║╔╝╚╝║║║╚╗╚╗╔╗╔╝║╔╗║║╚═╗║╔═╗╔╝X║╚═╗╔╗╔╝║║╚╗╚╝X║╚╝╚═╝╔╗║X╚╗║..........
.............╔╝╔╝.║║╚╝╔╗║║╚╗║X╚╗╚╗╔╝╔╝╔╗║╔╝║║║╚╗X║╔╝║╔╝╚╝╚╗║╔═╝╔╗║║╔═╗║║║╔═╗║║╚╗╚╗╚╝║╚╗║║║║╚╗╔╝║║╔╝║X╔╝╔╗╚╝║║╔╝╚╗╚═══╝╔╗╔╗╔╝║╚═╗╚╝..........
.............╚╗╚╗.╚╝╔═╝╚╝║X╚╝╔═╝╔╝╚╗╚╗║║╚╝X╚╝╚═╝╔╝╚╗║╚═╗XX╚╝╚═╗║║║║╚╗║║╚╝╚╗╚╝╚╗╚╗║╔═╝╔╝╚╝║║╔╝╚╗║║╚╗╚╗║╔╝╚══╝╚╝XX╚╗╔═╗╔╝╚╝║╚╗║╔╗╚╗...........
..............╚╗║.╔═╝╔╗╔╗║╔╗╔╝╔╗╚═╗╚╗╚╝╚════╗╔══╝╔╗║╚═╗╚╗╔╗╔══╝║║║║╔╝║╚══╗╚═╗╔╝X╚╝║╔╗╚═╗╔╝║╚╗╔╝╚╝X╚╗║║╚══════╗X╔╗║╚╗║╚══╗║╔╝║║╚═╝...........
...............╚╝.╚╗╔╝╚╝╚╝║║╚╗║║╔╗║╔╝╔══════╝╚═╗╔╝║╚╗X╚╗║║║╚══╗║║║║╚╗╚╗╔╗║╔═╝║X╔╗╔╝║║╔╗║╚╗╚╗║╚╗╔══╗╚╝║╔╗╔═══╗╚╗║╚╝╔╝╚═══╝╚╝╔╝║..............
...................║║╔═══╗║╚═╝║╚╝╚╝╚╗╚════╗╔╗╔═╝╚╗╚╗╚═╗║║║╚═══╝║║║╚╗║X╚╝╚╝╚═╗╚╗║║║╔╝║║║║X║╔╝╚═╝╚═╗╚══╝║║╚══╗╚╗║║╔╗╚═══════╗║╔╝..............
...................╚╝╚══╗╚╝╔╗╔╝X╔═══╝╔═╗╔╗╚╝║║╔═╗║╔╝╔═╝║║║╔╗╔═╗║║║╔╝╚═══╗╔══╝╔╝║╚╝╚╗║║║╚╗║╚═╗╔╗╔╗╚═╗╔╗║╚╗╔╗╚╗╚╝╚╝║╔══════╗║╚╝...............
.....................╔╗X╚═╗║║╚═╗╚═══╗╚╗║║║╔╗║╚╝╔╝║╚╗╚═╗║║╚╝║║X║║╚╝║╔╗╔╗╔╝║╔╗╔╝X╚╗╔╗║║║║╔╝║╔═╝║╚╝╚══╝║║╚╗║║╚╗╚═══╗║╚═════╗║║.................
....................╔╝╚═══╝║║╔╗╚╗╔══╝╔╝╚╝║║║║╔═╝╔╝╔╝╔╗║║║╔╗╚╝╔╝╚╗╔╝║╚╝║║X╚╝║╚══╗║║╚╝╚╝║╚╗║╚╗╔╝╔╗╔╗╔╗║╚╗║╚╝╔╝╔╗╔═╝╚╗╔═╗╔╗║╚╝.................
...................╔╝╔═══╗╔╝║║║╔╝╚═╗╔╝╔═╗║║╚╝╚═╗║╔╝╔╝║║║║║╚══╝╔╗║╚╗╚═╗╚╝╔══╝╔╗╔╝║╚═══╗╚╗║║╔╝║╔╝║║║║║║╔╝╚╗X╚╗║║╚══╗║╚╗║║╚╝...................
...................╚╗║╔══╝║X║║╚╝X╔═╝╚═╝╔╝╚╝╔═══╝║╚╗║X╚╝╚╝║╔══╗║║║╔╝╔╗║╔╗╚══╗║╚╝X║╔╗╔═╝.╚╝╚╝.╚╝.╚╝║║║║║╔╗║╔═╝║║╔╗╔╝║╔╝║║.....................
....................╚╝╚══╗╚╗║║╔══╝╔═╗╔╗╚╗╔╗╚═╗╔╗╚╗║╚╗╔╗XX╚╝╔═╝║║║╚╗║║╚╝╚═╗╔╝╚╗╔═╝║║╚══╗..........║║╚╝╚╝╚╝║╔╗║║║╚╝╔╝╚╗╚╝.....................
.......................╔═╝╔╝║║╚══╗║╔╝║╚╗╚╝╚╗╔╝║║╔╝╚╗╚╝╚╗╔╗X╚═╗║╚╝╔╝║║╔═══╝╚═╗║╚╗╔╝╚═╗╔╝..........╚╝...╔══╝║║║║╚═╗╚═╗╚═══╗...................
.......................║╔╗║X╚╝╔══╝║╚╗╚╗╚╗╔═╝╚╗║╚╝╔╗╚╗╔╗║║║╔╗X║║╔═╝╔╝║╚══╗.╔═╝║╔╝╚══╗╚╝...............╔╝╔═╗║║║╚╗╔╝╔═╝╔═╗╔╝...................
.......................╚╝║╚╗╔═╝╔═╗╚╗╚╗╚╗╚╝╔══╝╚╗╔╝╚═╝║║╚╝╚╝╚╗║║╚╗╔╝X╚╗╔╗║.╚═╗║╚╗╔╗╔╝.................╚═╝.╚╝║║╔╝║X╚╗╔╝.╚╝....................
........................╔╝╔╝╚═╗║╔╝╔╝.╚╗╚╗X║╔═╗╔╝╚╗╔═╗║╚╗╔╗╔═╝║║╔╝╚╗╔═╝║╚╝..╔╝║╔╝║║╚╗.......................╚╝╚╗╚═╗╚╝........................
........................╚╗╚═╗╔╝║║╔╝...╚╗╚╗║║╔╝║╔═╝║X║╚╗║║║╚╗.╚╝╚═╗║╚═╗╚╗...║╔╝╚╗║║╔╝......................╔═══╝╔═╝..........................
.........................╚╗╔╝╚╗║║╚═╗...╚╗║╚╝╚═╝╚╗╔╝╔╝╔╝╚╝╚═╝.....║║..╚╗╚═╗.╚╝..║║╚╝.......................╚╗╔═╗╚╗...........................
..........................╚╝..╚╝╚═╗║....║║╔═╗...║╚╗╚╗╚═╗.........╚╝...╚══╝.....╚╝..........................╚╝.╚═╝...........................
..................................║║.╔══╝╚╝╔╝...║╔╝╔╝╔╗╚╗...................................................................................
..................................╚╝.╚══╗╔═╝...╔╝║X╚╗║║╔╝...................................................................................
........................................╚╝.....╚╗║╔═╝║║╚╗...................................................................................
................................................╚╝╚══╝║╔╝...................................................................................
......................................................║║....................................................................................
......................................................╚╝....................................................................................
     */
    public static void main(String[] args) throws FileNotFoundException {
        FileInputStream fs = new FileInputStream("./src/day10.txt");
        Scanner in = new Scanner(fs);
        ArrayList<String> map = new ArrayList<>();
        int[] start = new int[2];
        int row = 0;
        while (in.hasNextLine()) {
            String s = in.nextLine();
            map.add(s);
            if (s.indexOf('S') != -1) {
                start[0] = row;
                start[1] = s.indexOf('S');
            }
            row++;
        }
        boolean[][] seen = new boolean[map.size()][map.get(0).length()];
        int[][] dist = new int[map.size()][map.get(0).length()];
        Stack<int[]> stack = new Stack<>();
        stack.push(new int[]{start[0], start[1], 0});
        stack.push(new int[]{start[0], start[1], 1});
        stack.push(new int[]{start[0], start[1], 2});
        stack.push(new int[]{start[0], start[1], 3});
        int inside = 2;
        while (!stack.empty()) {
            int[] curr = stack.pop();
            seen[curr[0]][curr[1]] = true;
            int x = curr[0];
            int y = curr[1];
            switch (curr[2]) {
                case 0 -> x--;
                case 1 -> x++;
                case 2 -> y--;
                case 3 -> y++;
            }
            if (inBounds(dist, new int[]{x, y}) && ((dist[x][y] > (dist[curr[0]][curr[1]] + 1)) || !seen[x][y])) {
                char c = map.get(x).charAt(y);
                switch (curr[2]) {
                    case 0 -> { // Up
                        if (c == '|') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 0});
                        } else if (c == '7') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 2});
                        } else if (c == 'F') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 3});
                        }
                    }
                    case 1 -> { // Down
                        if (c == '|') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 1});
                        } else if (c == 'J') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 2});
                        } else if (c == 'L') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 3});
                        }
                    }
                    case 2 -> { // Left
                        if (c == '-') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 2});
                        } else if (c == 'F') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 1});
                        } else if (c == 'L') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 0});
                        }
                    }
                    case 3 -> { // Right
                        if (c == '-') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 3});
                        } else if (c == '7') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 1});
                        } else if (c == 'J') {
                            dist[x][y] = dist[curr[0]][curr[1]] + 1;
                            stack.push(new int[]{x, y, 0});
                        }
                    }
                }
            }

        } // 6475

        int result = -1;
        for (int[] inner :
                dist) {
            for (int i :
                    inner) {
                result = Math.max(result, i);
            }
        }
        mark(dist);
        for (int k = 0; k < dist.length; k++) {
            int[] inner = dist[k];
            for (int j = 0; j < inner.length; j++) {
                int i = inner[j];
                if (i == -1) {
                    System.out.print(".");
                } else if (i == 0) {
                    System.out.print("■");
                } else {
//                    System.out.print(map.get(k).charAt(j));
                    switch (map.get(k).charAt(j)) {
                        case 'F' -> System.out.print('╔');
                        case 'L' -> System.out.print('╚');
                        case 'J' -> System.out.print('╝');
                        case '7' -> System.out.print('╗');
                        case '|' -> System.out.print('║');
                        case '-' -> System.out.print('═');
                        default -> System.out.print(map.get(k).charAt(j));
                    }
                }
            }
            System.out.println();
        }
        System.out.println(result);
    }

    public static boolean inLoop(ArrayList<String> grid, int[] coords) {
        // Mark group, add all to stack
        // Can go in diagonals and in-between pipes
        return false;
    }

    public static void mark(int[][] grid) {
        int[][] coords = {{0, 0}, {0, grid[0].length}, {grid.length, grid[0].length}, {grid.length, 0}};
        boolean[][] seen = new boolean[grid.length][grid[0].length];
        for (int[] coord :
                coords) {
            Stack<int[]> stack = new Stack<>();
            stack.push(coord);
            while (!stack.empty()) {
                int[] curr = stack.pop();
                for (int[] mod :
                        compass) {
                    int[] offset = new int[]{curr[0] + mod[0], curr[1] + mod[1]};
                    if (inBounds(grid, offset) && grid[offset[0]][offset[1]] == 0) {
                        stack.push(offset);
                        grid[offset[0]][offset[1]] = -1;
                    }
                }
            }
        }
    }

    public static boolean inBounds(int[][] arr, int[] coords) {
        return coords[0] < arr.length && coords[0] >= 0 && coords[1] < arr[0].length && coords[1] >= 0;
    }
}
